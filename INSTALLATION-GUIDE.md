# دليل التثبيت والإعداد - Communication Assistant Pro

## 📋 نظرة عامة

هذا الدليل يوضح خطوات تثبيت وإعداد نظام Communication Assistant Pro للتكامل مع PBX Grandstream.

---

## 🚀 متطلبات التثبيت

### متطلبات النظام الدنيا

| المكون | الحد الأدنى | الموصى به |
|---------|-------------|------------|
| **نظام التشغيل** | Windows 10 | Windows 11 |
| **المعالج** | Intel Core i3 | Intel Core i5 أو أحدث |
| **الذاكرة** | 4GB RAM | 8GB RAM |
| **مساحة القرص** | 500MB | 2GB |
| **الشبكة** | Ethernet | Gigabit Ethernet |
| **صلاحيات** | حساب مستخدم | حساب إداري |

### البرمجيات المطلوبة

- **.NET 8.0 Runtime** - [تحميل](https://dotnet.microsoft.com/download/dotnet/8.0)
- **Visual C++ Redistributable** - [تحميل](https://aka.ms/vs/17/release/vc_redist.x64.exe)
- **SQLite Browser** (اختياري) - [تحميل](https://sqlitebrowser.org/)

---

## 📦 عملية التثبيت

### الخطوة 1: تحضير البيئة

```bash
# 1. إنشاء مجلد التثبيت
mkdir "C:\Program Files\CommunicationAssistantPro"
cd "C:\Program Files\CommunicationAssistantPro"

# 2. نسخ ملفات التطبيق
# انسخ جميع ملفات المشروع إلى المجلد أعلاه
```

### الخطوة 2: تثبيت التبعيات

```bash
# تثبيت .NET 8.0 (إذا لم يكن مثبتاً)
# تحميل وتثبيت من الموقع الرسمي

# تثبيت Visual C++ Redistributable
# تحميل وتثبيت من Microsoft
```

### الخطوة 3: تكوين الصلاحيات

1. **إنشاء اختصار سطح المكتب:**
   ```bash
   الهدف: "C:\Program Files\CommunicationAssistantPro\CommunicationAssistantPro.exe"
   الاسم: Communication Assistant Pro
   الأيقونة: C:\Program Files\CommunicationAssistantPro\icon.ico
   ```

2. **تعيين صلاحيات المجلد:**
   - انقر بالزر الأيمن على مجلد البرنامج
   - اختر "Properties" > "Security"
   - أضف جميع المستخدمين مع صلاحيات "Full Control"

### الخطوة 4: تشغيل التطبيق الأولي

```bash
# تشغيل من سطر الأوامر للتحقق من الأخطاء
cd "C:\Program Files\CommunicationAssistantPro"
CommunicationAssistantPro.exe
```

---

## ⚙️ التكوين الأولي

### إعداد PBX Grandstream

#### إعداد AMI (Asterisk Manager Interface)

1. **الوصول إلى لوحة إدارة PBX:**
   - افتح متصفح الويب
   - اذهب إلى: `http://[PBX_IP]/`
   - سجل دخولك كمدير

2. **تفعيل AMI:**
   ```
   Settings > AMI Settings
   - ✅ Enable AMI
   - Port: 5038
   - Username: admin (أو حسب الحاجة)
   - Password: [اختر كلمة مرور قوية]
   ```

3. **تكوين الصلاحيات:**
   ```
   - Command: All
   - Monitor: All
   - Originate: All
   ```

#### إعداد HTTP API (بديل للـ AMI)

1. **تفعيل HTTP API:**
   ```
   Settings > HTTP API
   - ✅ Enable HTTP API
   - Port: 8080 (أو حسب الحاجة)
   - Authentication: Basic
   ```

2. **تكوين الصلاحيات:**
   - إضافة IP عنوان الكمبيوتر
   - تحديد الأذونات المطلوبة

### تكوين التطبيق

#### تسجيل الدخول الأولي

1. **بيانات الدخول الافتراضية:**
   ```
   Username: admin
   Password: admin123
   Extension: 1000
   ```

2. **تغيير كلمة المرور:**
   - انتقل إلى الإعدادات
   - إدارة المستخدمين
   - تغيير كلمة مرور المدير

#### تكوين الاتصال بـ PBX

1. **فتح نافذة الإعدادات:**
   - من القائمة الرئيسية > الإعدادات
   - أو من شاشة تسجيل الدخول > الإعدادات

2. **إعدادات PBX:**
   ```
   - عنوان IP: [عنوان IP لخادم PBX]
   - المنفذ: 5038 (AMI) أو 8080 (HTTP)
   - اسم المستخدم: [اسم المستخدم المكون]
   - كلمة المرور: [كلمة المرور المكونة]
   - طريقة الاتصال: AMI أو HTTP
   ```

3. **اختبار الاتصال:**
   - انقر على "اختبار الاتصال"
   - انتظر رسالة التأكيد
   - إذا فشل الاتصال، راجع إعدادات PBX

#### تكوين ملف حالة المكالمات

1. **تفعيل الملف:**
   ```
   Settings > Call File Settings
   - ✅ Enable Call Status File
   ```

2. **تحديد المسار:**
   ```
   File Path: C:\Temp\CaCallstatus.dat
   Timeout: 3 seconds
   ```

3. **إنشاء المجلد:**
   ```bash
   mkdir "C:\Temp"
   ```

---

## 🔧 التكوين المتقدم

### إعدادات الأمان

#### كلمات المرور
- **الحد الأدنى:** 8 أحرف
- **متطلبات:** حروف كبيرة، صغيرة، أرقام، رموز
- **انتهاء الصلاحية:** اختياري

#### تشفير البيانات
- **مفعل افتراضياً:** ✅
- **خوارزمية:** BCrypt
- **مستوى التشفير:** عالي

#### إدارة الجلسات
- **مهلة الجلسة:** 8 ساعات (480 دقيقة)
- **انتهاء تلقائي:** ✅
- **تسجيل الخروج عند الإغلاق:** ✅

### إعدادات قاعدة البيانات

#### مسارات الملفات
```json
{
  "DatabasePath": "C:\\Users\\[Username]\\AppData\\Local\\CommunicationAssistantPro\\Database\\CommunicationAssistant.db",
  "BackupPath": "C:\\Users\\[Username]\\AppData\\Local\\CommunicationAssistantPro\\Backups\\",
  "LogPath": "C:\\Users\\[Username]\\AppData\\Local\\CommunicationAssistantPro\\Logs\\"
}
```

#### النسخ الاحتياطية
- **التلقائية:** كل 24 ساعة
- **المحفوظة:** آخر 7 نسخ
- **المسار:** `/LocalAppData/CommunicationAssistantPro/Backups/`

### إعدادات الشبكة

#### جدار الحماية
```bash
# فتح المنافذ المطلوبة
netsh advfirewall firewall add rule name="CommunicationAssistantPro" dir=in action=allow program="C:\Program Files\CommunicationAssistantPro\CommunicationAssistantPro.exe"
```

#### Proxy (إذا كان مطلوباً)
```
Settings > Network
- ✅ Use Proxy
- Proxy Address: [عنوان الخادم]
- Proxy Port: [رقم المنفذ]
- Authentication: [حسب الحاجة]
```

---

## 🎯 إعداد المستخدمين

### إنشاء مستخدمين جدد

1. **من النافذة الرئيسية:**
   ```
   Menu > Settings > User Management
   ```

2. **إضافة مستخدم جديد:**
   ```
   - Full Name: [الاسم الكامل]
   - Username: [اسم المستخدم]
   - Password: [كلمة المرور]
   - Extension: [رقم الامتداد]
   - Department: [القسم]
   - Role: [الدور]
   ```

3. **تحديد الصلاحيات:**
   ```
   Employee: عرض المكالمات الشخصية
   Supervisor: إدارة المستخدمين
   Admin: إعدادات النظام
   SuperAdmin: جميع الصلاحيات
   ```

### استيراد المستخدمين من PBX

```bash
# إذا كان لديك قائمة مستخدمين في PBX
# يمكن استيرادها يدوياً أو البرمجة النصية
```

---

## 📊 إعداد التقارير

### التقارير الافتراضية

1. **تقارير يومية:**
   - تُنشأ تلقائياً كل يوم في 00:00
   - تُحفظ في مجلد التقارير

2. **تقارير أسبوعية:**
   - تُنشأ كل يوم اثنين في 00:00
   - تلخص نشاط الأسبوع السابق

3. **تقارير شهرية:**
   تُنشأ في أول كل شهر
   - تحليل شامل للشهر
   - مقارنات مع الأشهر السابقة

### تخصيص التقارير

1. **إعدادات التقارير:**
   ```
   Settings > Reports
   - Default Period: Daily
   - Auto Generate: ✅
   - Email Reports: ❌
   - Report Format: Excel, PDF
   ```

2. **قوالب التقارير:**
   - يمكن إنشاء قوالب مخصصة
   - حفظ التفضيلات لكل مستخدم

---

## 🧪 اختبار النظام

### اختبار الاتصال بـ PBX

1. **من نافذة الإعدادات:**
   - انقر "اختبار الاتصال"
   - راجع النتيجة

2. **اختبار المكالمات:**
   - اتصل بامتداد داخلي
   - تحقق من ظهور المكالمة في النظام

### اختبار قاعدة البيانات

```bash
# فحص قاعدة البيانات
sqlite3 CommunicationAssistant.db ".tables"
sqlite3 CommunicationAssistant.db "SELECT COUNT(*) FROM Users;"
```

### اختبار الأداء

1. **مراقبة استخدام الذاكرة:**
   - استخدم Task Manager
   - تحقق من استهلاك أقل من 200MB

2. **مراقبة استخدام القرص:**
   - تحقق من نمو ملفات السجل
   - راقب حجم قاعدة البيانات

---

## 🛠️ استكشاف الأخطاء الشائعة

### خطأ: "فشل الاتصال بـ PBX"

**الأسباب المحتملة:**
- عنوان IP خاطئ
- منفذ محجوز
- جدار الحماية
- إعدادات PBX خاطئة

**الحلول:**
1. تحقق من عنوان IP في إعدادات PBX
2. تأكد من أن المنفذ مفتوح
3. اختبر الاتصال بأداة telnet
4. راجع إعدادات AMI في PBX

```bash
# اختبار الاتصال بـ telnet
telnet 192.168.1.100 5038
```

### خطأ: "فشل في إنشاء قاعدة البيانات"

**الأسباب المحتملة:**
- عدم وجود صلاحيات
- مسار خاطئ
- مساحة القرص ممتلئة

**الحلول:**
1. تشغيل التطبيق كمدير
2. فحص المسار في الإعدادات
3. تنظيف مساحة القرص

### خطأ: "ملف CaCallstatus.dat لا يتم إنشاؤه"

**الحلول:**
1. تحقق من صلاحيات المجلد C:\Temp
2. تأكد من تفعيل إنشاء الملف
3. تحقق من مسار الملف في الإعدادات

```bash
# إنشاء مجلد Temp
mkdir C:\Temp
icacls C:\Temp /grant Users:F
```

---

## 🔄 الصيانة الدورية

### النسخ الاحتياطية

**أسبوعياً:**
```bash
# نسخ احتياطية يدوية
xcopy "C:\Users\[Username]\AppData\Local\CommunicationAssistantPro" "D:\Backups\CommunicationAssistantPro\[Date]\" /E /I
```

**شهرياً:**
- مراجعة إحصائيات الأداء
- تحديث كلمات المرور
- تنظيف السجلات القديمة

### تحديثات النظام

1. **فحص التحديثات:**
   - تشغيل "فحص التحديثات" من القائمة
   - أو زيارة موقع الدعم

2. **تطبيق التحديثات:**
   ```bash
   # إنشاء نسخة احتياطية قبل التحديث
   # إغلاق جميع النسخ من التطبيق
   # تشغيل ملف التحديث
   # إعادة تشغيل النظام
   ```

### مراقبة الأداء

**مؤشرات الأداء:**
- وقت استجابة واجهة المستخدم < 2 ثانية
- استخدام الذاكرة < 200MB
- حجم قاعدة البيانات < 100MB شهرياً

---

## 📞 الدعم والمساعدة

### معلومات الدعم

**للدعم التقني:**
- البريد الإلكتروني: support@basradelight.com
- الهاتف: [رقم الدعم]
- أوقات العمل: 8:00 ص - 5:00 م (توقيت العراق)

**للدعم الطارئ:**
- خارج ساعات العمل: [رقم الطوارئ]
- البريد الإلكتروني: emergency@basradelight.com

### موارد التعلم

- **دليل المستخدم:** [رابط]
- **الفيديوهات التعليمية:** [رابط]
- **الأسئلة الشائعة:** [رابط]
- **المجتمع:** [رابط]

---

## 📝 قائمة فحص التثبيت

### قبل التثبيت
- [ ] تأكد من استيفاء متطلبات النظام
- [ ] حمل جميع الملفات المطلوبة
- [ ] احتفظ بنسخة احتياطية من البيانات الحالية (إن وجدت)

### أثناء التثبيت
- [ ] تثبيت .NET 8.0 Runtime
- [ ] تثبيت Visual C++ Redistributables
- [ ] نسخ ملفات التطبيق
- [ ] إنشاء اختصار سطح المكتب
- [ ] اختبار تشغيل التطبيق

### بعد التثبيت
- [ ] تكوين الاتصال بـ PBX
- [ ] اختبار الاتصال
- [ ] إنشاء مستخدمين جدد
- [ ] اختبار المكالمات
- [ ] تكوين النسخ الاحتياطية
- [ ] تدريب المستخدمين

---

*آخر تحديث: 2025-10-26*  
*© 2025 Basra Delight Group - جميع الحقوق محفوظة*